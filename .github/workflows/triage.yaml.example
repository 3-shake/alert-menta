# Example workflow for auto-triage
# Copy this file to .github/workflows/triage.yaml and customize

name: "Auto Triage"
run-name: AI triages new issues

on:
  issues:
    types: [opened]

jobs:
  triage:
    runs-on: ubuntu-24.04
    permissions:
      issues: write
      contents: read
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4

      - name: Download and Install alert-menta
        run: |
          curl -sLJO -H 'Accept: application/octet-stream' \
          "https://${{ secrets.GH_TOKEN }}@api.github.com/repos/3-shake/alert-menta/releases/assets/$( \
          curl -sL "https://${{ secrets.GH_TOKEN }}@api.github.com/repos/3-shake/alert-menta/releases/latest" \
          | jq '.assets[] | select(.name | contains("Linux_x86")) | .id')"
          tar -zxvf alert-menta_Linux_x86_64.tar.gz

      - name: Run Auto Triage
        run: |
          ./alert-menta-triage \
            -owner ${{ github.repository_owner }} \
            -repo ${{ github.event.repository.name }} \
            -issue ${{ github.event.issue.number }} \
            -github-token ${{ secrets.GH_TOKEN }} \
            -api-key ${{ secrets.OPENAI_API_KEY }} \
            -config .alert-menta.user.yaml
