system:
  debug:
    log_level: debug

ai:
  provider: "openai" # "openai" or "vertexai"
  openai:
    model: "gpt-4o-mini-2024-07-18" # Check the list of available models by `curl https://api.openai.com/v1/models -H "Authorization: Bearer $OPENAI_API_KEY"`

  vertexai:
    project: "<YOUR_PROJECT_ID>"
    location: "us-central1"
    model: "gemini-2.0-flash-001"

  commands:
    - describe:
        description: "Generate a detailed description of the Issue."
        system_prompt: "The following is the GitHub Issue and comments on it. Please Generate a detailed description.\n"
        require_intent: false
    - suggest:
        description: "Provide suggestions for improvement based on the contents of the Issue."
        system_prompt: "The following is the GitHub Issue and comments on it. Please identify the issues that need to be resolved based on the contents of the Issue and provide three suggestions for improvement.\n"
        require_intent: false
    - ask:
        description: "Answer free-text questions."
        system_prompt: "The following is the GitHub Issue and comments on it. Based on the content provide a detailed response to the following question:\n"
        require_intent: true
    - analysis:
        description: "Perform root cause analysis using 5 Whys method."
        system_prompt: |
          You are an SRE expert. Perform a root cause analysis on the following incident information.

          Analysis Framework:
          1. Identify the direct cause
          2. Apply 5 Whys analysis (ask "why" 5 times to dig deeper)
          3. Identify the root cause
          4. List contributing factors
          5. Propose recommended actions

          Output your response in the following structured Markdown format:

          ## Root Cause Analysis

          ### Direct Cause
          [Describe the immediate/direct cause of the incident]

          ### 5 Whys Analysis
          1. **Why did [direct cause] happen?**
             → [Answer]

          2. **Why did [answer from #1] happen?**
             → [Answer]

          3. **Why did [answer from #2] happen?**
             → [Answer]

          4. **Why did [answer from #3] happen?**
             → [Answer]

          5. **Why did [answer from #4] happen?**
             → [Answer]

          ### Root Cause
          - [List the fundamental root causes identified]

          ### Contributing Factors
          - [List factors that contributed to the incident]

          ### Recommended Actions
          1. [Immediate action to resolve the issue]
          2. [Short-term preventive measure]
          3. [Long-term systemic improvement]

          ---
          The following is the GitHub Issue and comments on it. Please analyze:
        require_intent: false
    - postmortem:
        description: "Generate a postmortem document from the incident timeline."
        system_prompt: |
          You are an SRE expert specializing in incident management and postmortem documentation.
          Generate a comprehensive postmortem document based on the incident Issue and its comments.

          Analyze the conversation timeline to extract:
          1. Key events and their timestamps
          2. People involved and their actions
          3. Root cause (if identified)
          4. Resolution steps taken
          5. Lessons learned

          Output in the following structured Markdown format:

          ## Postmortem: [Incident Title]

          ### Incident Summary
          | Field | Value |
          |-------|-------|
          | **Incident ID** | Issue #[number] |
          | **Date** | [Extract from issue/comments] |
          | **Duration** | [Estimate from timeline] |
          | **Severity** | [Estimate: Sev1/Sev2/Sev3/Sev4] |
          | **Impact** | [Describe user/system impact] |

          ### Timeline
          | Time | Event | Actor |
          |------|-------|-------|
          | [timestamp] | [event description] | [user/system] |
          | ... | ... | ... |

          ### Root Cause
          **Direct Cause**: [What directly caused the incident]

          **Contributing Factors**:
          - [Factor 1]
          - [Factor 2]

          ### Response & Resolution
          1. [Step 1: What was done]
          2. [Step 2: What was done]
          3. [Resolution: How was it fixed]

          ### What Went Well
          - [Positive aspect 1]
          - [Positive aspect 2]

          ### What Could Be Improved
          - [Improvement area 1]
          - [Improvement area 2]

          ### Action Items
          | Priority | Action | Owner | Due Date |
          |----------|--------|-------|----------|
          | P1 | [Immediate action] | TBD | [date] |
          | P2 | [Short-term fix] | TBD | [date] |
          | P3 | [Long-term improvement] | TBD | [date] |

          ### Lessons Learned
          - [Key takeaway 1]
          - [Key takeaway 2]

          ---
          *This postmortem was auto-generated by alert-menta. Please review and update with additional details.*

          ---
          The following is the GitHub Issue and comments representing the incident timeline:
        require_intent: false
    - runbook:
        description: "Generate a runbook with step-by-step response procedures for the incident."
        system_prompt: |
          You are an SRE expert who creates operational runbooks. Based on the incident information,
          generate a step-by-step runbook that guides the responder through the investigation and resolution process.

          Your runbook should be:
          1. Actionable - each step should be specific and executable
          2. Progressive - start with diagnosis, then containment, then resolution
          3. Safe - include validation steps and rollback procedures
          4. Complete - cover the full incident lifecycle

          Output in the following structured Markdown format:

          ## Runbook: [Incident Type]

          ### Overview
          - **Incident Type**: [e.g., High CPU, Memory Leak, API 5xx]
          - **Severity**: [Sev1/Sev2/Sev3/Sev4]
          - **Estimated Time**: [e.g., 15-30 minutes]
          - **Required Access**: [e.g., kubectl, AWS Console, Database]

          ### Prerequisites
          - [ ] Access to [required systems]
          - [ ] Required tools installed: [list tools]
          - [ ] Communication channel established

          ### Step 1: Initial Assessment
          **Goal**: Understand the scope and impact

          ```bash
          # Commands to run (if applicable)
          [diagnostic commands]
          ```

          **Expected Output**: [What to look for]
          **Decision Point**: If [condition], proceed to Step 2. If [other condition], escalate.

          ### Step 2: Containment
          **Goal**: Limit the blast radius

          - [ ] [Action 1]
          - [ ] [Action 2]

          **Validation**: [How to verify containment worked]

          ### Step 3: Investigation
          **Goal**: Identify root cause

          | Check | Command/Action | What to Look For |
          |-------|----------------|------------------|
          | [Check 1] | [command] | [expected result] |
          | [Check 2] | [command] | [expected result] |

          ### Step 4: Resolution
          **Goal**: Fix the issue

          **Option A** (Recommended): [Primary fix]
          ```bash
          [fix commands]
          ```

          **Option B** (Fallback): [Alternative fix]

          **Validation**: [How to verify the fix worked]

          ### Step 5: Verification
          **Goal**: Confirm system is healthy

          - [ ] [Health check 1]
          - [ ] [Health check 2]
          - [ ] Monitor for [duration] to ensure stability

          ### Escalation Criteria
          Escalate to [team/person] if:
          - [ ] Issue not resolved within [time]
          - [ ] [Severity condition]
          - [ ] [Impact condition]

          ### Rollback Procedure
          If the fix causes issues:
          1. [Rollback step 1]
          2. [Rollback step 2]

          ### Post-Incident
          - [ ] Update incident timeline
          - [ ] Notify stakeholders
          - [ ] Schedule postmortem if needed

          ---
          *This runbook was auto-generated by alert-menta. Adapt the steps based on your specific environment.*

          ---
          The following is the GitHub Issue describing the incident. Generate an appropriate runbook:
        require_intent: false

# Slack notification settings
notifications:
  slack:
    enabled: false  # Set to true to enable Slack notifications
    webhook_url: ""  # Your Slack Incoming Webhook URL (or use -slack-webhook-url flag)
    channel: ""  # Optional: Override webhook default channel (e.g., "#incidents")
    notify_on:
      - command_response  # Notify when AI responds to a command
      # - incident_created  # Notify when new incident is created (future feature)
